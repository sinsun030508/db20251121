<%
// list.ejs
// 렌더링 시: posts, page, totalPages, keyword
%>
<%- include('layout', {
  title: '게시판 목록',
  body: `
<section>
  <form method="get" action="/board" class="search-form">
    <input type="text" name="keyword" placeholder="제목 검색" value="${keyword || ''}">
    <button type="submit">검색</button>
  </form>

  <div class="list-header">
    <h2>게시글 목록</h2>
    <a href="/board/new" class="btn">글쓰기</a>
  </div>

  <table class="board-table">
    <thead>
      <tr>
        <th>No</th>
        <th>제목</th>
        <th>작성자</th>
        <th>작성일</th>
        <th>조회수</th>
      </tr>
    </thead>
    <tbody>
      ${
        posts.length === 0
          ? `<tr><td colspan="5" class="empty">게시글이 없습니다.</td></tr>`
          : posts.map((post, idx) => `
            <tr>
              <td>${post.id}</td>
              <td><a href="/board/${post.id}">${post.title}</a></td>
              <td>${post.writer || ''}</td>
              <td>${post.created_at.toISOString().slice(0, 19).replace('T', ' ')}</td>
              <td>${post.hit}</td>
            </tr>
          `).join('')
      }
    </tbody>
  </table>

  <div class="pagination">
    ${
      Array.from({ length: totalPages }, (_, i) => i + 1)
        .map(p => {
          const link = `/board?page=${p}${keyword ? '&keyword=' + encodeURIComponent(keyword) : ''}`;
          if (p === page) {
            return `<span class="current">${p}</span>`;
          }
          return `<a href="${link}">${p}</a>`;
        })
        .join(' ')
    }
  </div>
</section>
` }) %>
